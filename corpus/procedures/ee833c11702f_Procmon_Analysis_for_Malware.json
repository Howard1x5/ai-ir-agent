{
  "id": "ee833c11702f",
  "title": "Procmon Analysis for Malware",
  "content": "\n# Process Monitor (Procmon) Analysis for Malware\n\n## Setup Before Execution\n1. Start Procmon (run as Administrator)\n2. Clear existing events: Ctrl+X\n3. Set up filters BEFORE running sample:\n   - Process Name contains <sample_name>\n   - Path contains C:\\Users\n   - Path contains C:\\Windows\\Temp\n   - Path contains AppData\n   - Path contains ProgramData\n   - Operation is WriteFile\n   - Operation is CreateFile\n   - Operation is RegSetValue\n\n## Key Things to Watch For\n\n### File Operations\n- WriteFile to Temp directories\n- CreateFile in startup locations:\n  - C:\\Users\\<user>\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\n  - C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\n- Files dropped with executable extensions (.exe, .dll, .scr, .bat, .ps1)\n\n### Registry Operations\n- Run keys: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n- Services: HKLM\\SYSTEM\\CurrentControlSet\\Services\n- Scheduled Tasks registry entries\n- Image File Execution Options (debugging hijack)\n\n### Network Operations\n- TCP/UDP Connect operations\n- DNS queries visible in detail column\n\n### Process Operations\n- Process Create showing child processes\n- Process Start showing command lines\n\n## Filtering Tips\n- Use Path filters to focus on user-writable locations\n- Filter by Category: Write, Network\n- Exclude known good: Filter out svchost, System, etc. AFTER initial run\n\n## Export\n- File > Save as CSV for parsing\n- Include: Time, Process Name, PID, Operation, Path, Result, Detail\n",
  "source": "generated_procedure",
  "source_type": "procedure",
  "url": null,
  "metadata": {
    "quality": "high"
  }
}