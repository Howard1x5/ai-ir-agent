{
  "id": "00927c67fb14",
  "title": "PowerShell Malware Analysis",
  "content": "\n# PowerShell Malware Analysis Procedure\n\n## Deobfuscation Techniques\n\n### Base64 Encoded Commands\n- Look for: -EncodedCommand, -enc, -e flags\n- Decode: [System.Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('...'))\n- In CyberChef: From Base64 -> Decode Text (UTF-16LE)\n\n### String Concatenation\n- PowerShell often uses: \"Down\" + \"load\" + \"String\"\n- Manually concatenate or use PowerShell ISE to evaluate\n\n### Character Code Obfuscation\n- [char]72 = 'H', [char]101 = 'e', etc.\n- Evaluate arrays: [char[]]@(72,101,108,108,111) -join ''\n\n### Invoke-Expression (IEX) Unwrapping\n- Replace IEX/Invoke-Expression with Write-Output\n- This reveals the code without executing it\n\n## Tools\n- PowerShell ISE (isolated VM only!)\n- CyberChef for encoding/decoding\n- PowerDecode for automated deobfuscation\n\n## Common Indicators\n- Download cradles: Invoke-WebRequest, Net.WebClient, BITS\n- Execution: Invoke-Expression, & operator, . sourcing\n- Persistence: ScheduledTask, Registry, WMI subscription\n",
  "source": "generated",
  "source_type": "procedure",
  "url": null,
  "metadata": null
}